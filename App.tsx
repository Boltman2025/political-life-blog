import React, { useState, useEffect } from 'react';
import { Header } from './components/Header';
import { NewsTicker } from './components/NewsTicker';
import { ArticleCard } from './components/ArticleCard';
import { Sidebar } from './components/Sidebar';
import { ArticleView } from './components/ArticleView';
import { Footer } from './components/Footer';
import { Article, ViewState } from './types';

// Mock Data for the Blog
const MOCK_ARTICLES: Article[] = [
  {
    id: '1',
    title: "الجزائر تؤكد التزامها بدعم الاستقرار الإقليمي في القمة الأفريقية",
    excerpt: "جدد رئيس الجمهورية خلال مشاركته في القمة الأفريقية التزام الجزائر الراسخ بدعم جهود السلم والأمن في القارة، مشدداً على ضرورة تكاتف الجهود لمواجهة التحديات الراهنة.",
    content: `أديس أبابا - جدد رئيس الجمهورية، اليوم، التزام الجزائر الثابت والمبدئي بدعم كل الجهود الرامية إلى تحقيق السلم والاستقرار في القارة الأفريقية. وأكد الرئيس في كلمته أمام القادة الأفارقة أن التحديات الأمنية والاقتصادية التي تواجهها القارة تتطلب استجابة جماعية ومنسقة.

    وأشار الرئيس إلى أن الجزائر، بحكم موقعها وتاريخها، لن تدخر جهداً في سبيل الدفع بمسار التسوية السلمية للنزاعات، مؤكداً على أهمية الحلول السياسية والدبلوماسية بعيداً عن التدخلات الأجنبية التي غالباً ما تزيد الأوضاع تعقيداً.
    
    كما تطرق الخطاب إلى الجانب الاقتصادي، حيث دعت الجزائر إلى تسريع تفعيل منطقة التجارة الحرة القارية الأفريقية، معتبرة إياها أداة حيوية لتحقيق التكامل الاقتصادي والازدهار للشعوب الأفريقية.
    
    وفي ختام كلمته، شدد الرئيس على ضرورة إصلاح مجلس الأمن الدولي بما يضمن تمثيلاً عادلاً للقارة الأفريقية، تصحيحاً للظلم التاريخي الذي تعرضت له القارة.`,
    category: "وطني",
    author: "كريم بن صالح",
    date: "24 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=1",
    isBreaking: true
  },
  {
    id: '2',
    title: "وزارة الطاقة تعلن عن اكتشافات نفطية جديدة في الجنوب الكبير",
    excerpt: "أعلنت شركة سوناطراك اليوم عن نجاحها في تحقيق اكتشافات نفطية وغازية جديدة في حوض بركين، مما يعزز مكانة الجزائر كمورد طاقوي موثوق.",
    content: "أعلنت وزارة الطاقة والمناجم، في بيان لها اليوم، عن تحقيق مجمع سوناطراك لعدة اكتشافات نفطية وغازية هامة في الجنوب الكبير. وتأتي هذه الاكتشافات في إطار استراتيجية الشركة لتجديد احتياطاتها وتعزيز قدراتها الإنتاجية.\n\nوأوضح البيان أن الاكتشافات الجديدة تقع في حوض بركين ومنطقة حاسي مسعود، وتشير التقديرات الأولية إلى وجود احتياطيات معتبرة قابلة للاستغلال التجاري. وأكد وزير الطاقة أن هذه النتائج مشجعة جداً وتؤكد على الإمكانات الهائلة التي تزخر بها باطن الأرض الجزائرية.\n\nومن المنتظر أن تساهم هذه الاكتشافات في رفع صادرات الجزائر من المحروقات، في وقت يشهد فيه السوق العالمي للنفط والغاز طلباً متزايداً. كما ستفتح هذه المشاريع آفاقاً جديدة للتشغيل والتنمية في المناطق الجنوبية.",
    category: "اقتصاد",
    author: "نادية منصوري",
    date: "23 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=2"
  },
  {
    id: '3',
    title: "مشروع قانون المالية 2024: زيادة في الأجور ودعم للقدرة الشرائية",
    excerpt: "تضمن مشروع قانون المالية لسنة 2024 إجراءات هامة تهدف إلى حماية القدرة الشرائية للمواطن، من خلال مراجعة الشبكة الاستدلالية للأجور ورفع منحة البطالة.",
    content: "صادق مجلس الوزراء المنعقد اليوم برئاسة رئيس الجمهورية على مشروع قانون المالية لسنة 2024، الذي حمل طابعاً اجتماعياً بامتياز. وتضمن المشروع عدة تدابير تهدف بالأساس إلى حماية القدرة الشرائية للمواطنين وتحسين الظروف المعيشية.\n\nومن أبرز ما جاء في المشروع، الزيادة المقررة في أجور الموظفين، والتي ستدخل حيز التنفيذ بداية من العام المقبل، بالإضافة إلى مراجعة منح التقاعد ورفع منحة البطالة. كما خصصت الحكومة ميزانية ضخمة للتحويلات الاجتماعية ودعم المواد واسعة الاستهلاك.\n\nوعلى الصعيد الاقتصادي، تضمن المشروع تحفيزات جبائية للمؤسسات الناشئة والمستثمرين الشباب، في إطار سعي الدولة لتنويع الاقتصاد الوطني والخروج من التبعية للمحروقات.",
    category: "اقتصاد",
    author: "عبد القادر مساهل",
    date: "22 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=3"
  },
  {
    id: '4',
    title: "الجزائر تستضيف المنتدى الدولي للبيئة والطاقات المتجددة",
    excerpt: "تحتضن الجزائر العاصمة فعاليات المنتدى الدولي للبيئة، بمشاركة خبراء ومختصين من مختلف دول العالم لمناقشة تحديات التغير المناخي.",
    content: "انطلقت اليوم بقصر المؤتمرات عبد اللطيف رحال، فعاليات المنتدى الدولي للبيئة والطاقات المتجددة، تحت شعار 'مستقبل أخضر لأفريقيا'. ويشهد المنتدى مشاركة واسعة لوزراء البيئة من الدول الأفريقية والأوروبية، إضافة إلى خبراء وممثلين عن المنظمات الدولية.\n\nويهدف المنتدى إلى تبادل الخبرات والتجارب في مجال الانتقال الطاقوي ومكافحة التغيرات المناخية. وتستعرض الجزائر خلال هذا الحدث تجربتها الرائدة في مجال الطاقات المتجددة، خاصة مشروع 'سولار 1000' للطاقة الشمسية.\n\nوعلى هامش المنتدى، تم التوقيع على عدة اتفاقيات شراكة بين مؤسسات جزائرية وأجنبية لتطوير مشاريع في مجال تدوير النفايات والاقتصاد الأخضر.",
    category: "مجتمع",
    author: "سميرة بوعلام",
    date: "21 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=4"
  },
  {
    id: '5',
    title: "المنتخب الوطني يبدأ معسكره التدريبي تحضيراً لكأس الأمم الأفريقية",
    excerpt: "الناخب الوطني يؤكد جاهزية العناصر الوطنية واستعدادهم لرفع التحدي في المنافسة القارية القادمة بكوت ديفوار.",
    content: "شرع المنتخب الوطني لكرة القدم اليوم في تربصه التحضيري بالمركز التقني لسيدي موسى، استعداداً لنهائيات كأس الأمم الأفريقية المقررة في كوت ديفوار. وشهدت الحصة التدريبية الأولى حضور جل اللاعبين المحترفين.\n\nوأكد الناخب الوطني في ندوة صحفية عقدها قبل انطلاق التدريبات، أن الهدف المسطر هو الذهاب بعيداً في هذه المنافسة وتشريف الراية الوطنية. وأشار إلى أن التشكيلة الحالية تمزج بين الخبرة والشباب، مما يمنح الخضر حظوظاً وافرة للمنافسة على اللقب.\n\nمن جهتهم، عبر اللاعبون عن عزمهم الكبير على إسعاد الجماهير الجزائرية ومحو آثار النتائج السلبية المسجلة في الفترة الأخيرة.",
    category: "رياضة",
    author: "رياض محرزي",
    date: "24 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=5"
  },
  {
    id: '6',
    title: "افتتاح الطبعة الـ 26 لصالون الجزائر الدولي للكتاب",
    excerpt: "وزيرة الثقافة تشرف على افتتاح صالون الجزائر الدولي للكتاب بمشاركة قياسية لدور النشر من مختلف القارات.",
    content: "أشرفت وزيرة الثقافة والفنون اليوم على الافتتاح الرسمي للطبعة السادسة والعشرين لصالون الجزائر الدولي للكتاب (سيلا)، الذي يعتبر أكبر تظاهرة ثقافية في البلاد. وتعرف هذه الطبعة مشاركة قياسية لأكثر من 1200 دار نشر تمثل 60 دولة.\n\nوتحل أفريقيا ضيف شرف هذه الدورة، احتفاءً بالثقافة والأدب الأفريقي. ويتضمن البرنامج الثقافي للصالون ندوات فكرية، جلسات بيع بالتوقيع، وورشات عمل للأطفال.\n\nويشهد الصالون منذ ساعاته الأولى إقبالاً كبيراً من طرف المواطنين الشغوفين بالقراءة والمطالعة، مما يؤكد مكانة الكتاب في المجتمع الجزائري رغم تحديات العصر الرقمي.",
    category: "ثقافة",
    author: "أمينة كاتب",
    date: "25 أكتوبر 2023",
    imageUrl: "https://picsum.photos/800/600?random=6"
  }
];

export default function App() {
  const [view, setView] = useState<ViewState>(ViewState.HOME);
  const [selectedArticle, setSelectedArticle] = useState<Article | null>(null);

  // Scroll to top when view changes
  useEffect(() => {
    window.scrollTo(0, 0);
  }, [view, selectedArticle]);

  const handleArticleClick = (article: Article) => {
    setSelectedArticle(article);
    setView(ViewState.ARTICLE);
  };

  const handleHomeClick = () => {
    setView(ViewState.HOME);
    setSelectedArticle(null);
  };

  const renderHome = () => {
    const featured = MOCK_ARTICLES[0];
    const latest = MOCK_ARTICLES.slice(1);

    return (
      <div className="flex flex-col lg:flex-row gap-8">
        <main className="w-full lg:w-2/3">
          <div className="mb-10">
            <h2 className="text-xl font-bold mb-4 border-r-4 border-[#ce1126] pr-3 text-gray-800">الحدث الرئيسي</h2>
            <ArticleCard article={featured} onClick={handleArticleClick} featured={true} />
          </div>

          <div>
            <h2 className="text-xl font-bold mb-6 border-r-4 border-[#ce1126] pr-3 text-gray-800">آخر الأخبار</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {latest.map(article => (
                <ArticleCard key={article.id} article={article} onClick={handleArticleClick} />
              ))}
            </div>
          </div>
        </main>

        <Sidebar articles={MOCK_ARTICLES} onArticleClick={handleArticleClick} />
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-[#f9fafb] text-gray-900 font-sans">
      <Header onHomeClick={handleHomeClick} />
      <NewsTicker />
      
      <div className="container mx-auto px-4 py-8">
        {view === ViewState.HOME && renderHome()}
        {view === ViewState.ARTICLE && selectedArticle && (
          <ArticleView 
            article={selectedArticle} 
            relatedArticles={MOCK_ARTICLES.filter(a => a.id !== selectedArticle.id)}
            onArticleClick={handleArticleClick}
          />
        )}
      </div>

      <Footer />
    </div>
  );
}